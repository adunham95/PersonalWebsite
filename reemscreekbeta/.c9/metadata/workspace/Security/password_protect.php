{"changed":true,"filter":false,"title":"password_protect.php","tooltip":"/Security/password_protect.php","value":"<?php\n\n###############################################################\n# Page Password Protect 2.13\n###############################################################\n# Visit http://www.zubrag.com/scripts/ for updates\n############################################################### \n#\n# Usage:\n# Set usernames / passwords below between SETTINGS START and SETTINGS END.\n# Open it in browser with \"help\" parameter to get the code\n# to add to all files being protected. \n#    Example: password_protect.php?help\n# Include protection string which it gave you into every file that needs to be protected\n#\n# Add following HTML code to your page where you want to have logout link\n# <a href=\"http://www.example.com/path/to/protected/page.php?logout=1\">Logout</a>\n#\n###############################################################\n\n/*\n-------------------------------------------------------------------\nSAMPLE if you only want to request login and password on login form.\nEach row represents different user.\n\n$LOGIN_INFORMATION = array(\n  'zubrag' => 'root',\n  'test' => 'testpass',\n  'admin' => 'passwd'\n);\n\n--------------------------------------------------------------------\nSAMPLE if you only want to request only password on login form.\nNote: only passwords are listed\n\n$LOGIN_INFORMATION = array(\n  'root',\n  'testpass',\n  'passwd'\n);\n\n--------------------------------------------------------------------\n*/\n\n##################################################################\n#  SETTINGS START\n##################################################################\n\n// Add login/password pairs below, like described above\n// NOTE: all rows except last must have comma \",\" at the end of line\n$LOGIN_INFORMATION = array(\n  'zubrag' => 'root',\n  'admin' => 'adminpass',\n  'adunham'  => 'password',\n  'guest' => 'guest'\n);\n\n// request login? true - show login and password boxes, false - password box only\ndefine('USE_USERNAME', true);\n\n// User will be redirected to this page after logout\ndefine('LOGOUT_URL', 'http://www.example.com/');\n\n// time out after NN minutes of inactivity. Set to 0 to not timeout\ndefine('TIMEOUT_MINUTES', 0);\n\n// This parameter is only useful when TIMEOUT_MINUTES is not zero\n// true - timeout time from last activity, false - timeout time from login\ndefine('TIMEOUT_CHECK_ACTIVITY', true);\n\n##################################################################\n#  SETTINGS END\n##################################################################\n\n\n///////////////////////////////////////////////////////\n// do not change code below\n///////////////////////////////////////////////////////\n\n// show usage example\nif(isset($_GET['help'])) {\n  die('Include following code into every page you would like to protect, at the very beginning (first line):<br>&lt;?php include(\"' . str_replace('\\\\','\\\\\\\\',__FILE__) . '\"); ?&gt;');\n}\n\n// timeout in seconds\n$timeout = (TIMEOUT_MINUTES == 0 ? 0 : time() + TIMEOUT_MINUTES * 60);\n\n// logout?\nif(isset($_GET['logout'])) {\n  setcookie(\"verify\", '', $timeout, '/'); // clear password;\n  header('Location: ' . LOGOUT_URL);\n  exit();\n}\n\nif(!function_exists('showLoginPasswordProtect')) {\n\n// show login form\nfunction showLoginPasswordProtect($error_msg) {\n?>\n<html>\n<head>\n  <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <!-- The above 3 meta tags *must* come first in the head;\nany other head content must come *after* these tags -->\n    <meta name=\"description\" content=\"\">\n    <meta name=\"author\" content=\"\">\n    <link rel=\"icon\" href=\"../../favicon.ico\">\n    <title>Please enter password to access this page</title>\n    <!-- Bootstrap core CSS -->\n    <link href=\"../Bootstrap/bootstrap-paper.min.css\" rel=\"stylesheet\">\n    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->\n    <link href=\"../../assets/css/ie10-viewport-bug-workaround.css\" rel=\"stylesheet\">\n    <!-- Custom styles for this template -->\n    <link href=\"signin.css\" rel=\"stylesheet\">\n    <link href=\"../Custom%20Css/Colors.css\" rel=\"stylesheet\">\n    <link href=\"../Custom%20Css/Personal.css\" rel=\"stylesheet\">\n  <META HTTP-EQUIV=\"CACHE-CONTROL\" CONTENT=\"NO-CACHE\">\n  <META HTTP-EQUIV=\"PRAGMA\" CONTENT=\"NO-CACHE\">\n</head>\n<body style=\"background: url(reemscreek/Photos/sunset1.jpg) no-repeat center center fixed; -webkit-background-size: cover;\n-moz-background-size: cover;\n  -o-background-size: cover;\n  background-size: cover\" \n  class=\"well\">\n  <style>\n    input { border: 1px solid black; }\n  </style>\n  <?php include( \"navupdate.html\"); ?>\n    <div class=\"container\">\n        <div class=\"row\">\n            <div class=\"col-md-6 col-md-offset-3\">\n                <form class=\"form-signin\" method=\"post\">\n                  <h2 class=\"form-signin-heading white-text text-center text-uppercase\">Please sign in</h2>\n                  <font color=\"red\"><?php echo $error_msg; ?></font><br />\n                  <?php if (USE_USERNAME) echo '<p class=\"white-text\">Login</p?:<br /><input type=\"input\" name=\"access_login\" class=\"form-control white-text\"/><br />Password:<br />'; ?>\n                    <!--<label for=\"inputEmail\" class=\"sr-only\">Username</label>\n                    <input type=\"input\" name=\"access_login\" class=\"form-control\" placeholder=\"Username\" required autofocus>\n                    <label for=\"inputPassword\" class=\"sr-only\">Password</label>-->\n                    <input type=\"password\" name=\"access_password\" class=\"form-control\" required>\n                    <button class=\"btn btn-lg btn-primary btn-block orange darken-3\" type=\"submit\" name=\"Submit\">Sign in</button>\n                </form>\n                <a style=\"font-size:9px; color: #B0B0B0; font-family: Verdana, Arial;\" href=\"http://www.zubrag.com/scripts/password-protect-advanced.php\" title=\"Download Password Protect\">Powered by Password Protect</a>\n            </div>\n        </div>\n    </div>\n  <br />\n</body>\n</html>\n\n<?php\n  // stop at this point\n  die();\n}\n}\n\n// user provided password\nif (isset($_POST['access_password'])) {\n\n  $login = isset($_POST['access_login']) ? $_POST['access_login'] : '';\n  $pass = $_POST['access_password'];\n  if (!USE_USERNAME && !in_array($pass, $LOGIN_INFORMATION)\n  || (USE_USERNAME && ( !array_key_exists($login, $LOGIN_INFORMATION) || $LOGIN_INFORMATION[$login] != $pass ) ) \n  ) {\n    showLoginPasswordProtect(\"Incorrect password.\");\n  }\n  else {\n    // set cookie if password was validated\n    setcookie(\"verify\", md5($login.'%'.$pass), $timeout, '/');\n    \n    // Some programs (like Form1 Bilder) check $_POST array to see if parameters passed\n    // So need to clear password protector variables\n    unset($_POST['access_login']);\n    unset($_POST['access_password']);\n    unset($_POST['Submit']);\n  }\n\n}\n\nelse {\n\n  // check if password cookie is set\n  if (!isset($_COOKIE['verify'])) {\n    showLoginPasswordProtect(\"\");\n  }\n\n  // check if cookie is good\n  $found = false;\n  foreach($LOGIN_INFORMATION as $key=>$val) {\n    $lp = (USE_USERNAME ? $key : '') .'%'.$val;\n    if ($_COOKIE['verify'] == md5($lp)) {\n      $found = true;\n      // prolong timeout\n      if (TIMEOUT_CHECK_ACTIVITY) {\n        setcookie(\"verify\", md5($lp), $timeout, '/');\n      }\n      break;\n    }\n  }\n  if (!$found) {\n    showLoginPasswordProtect(\"\");\n  }\n\n}\n\n?>\n","undoManager":{"mark":51,"position":53,"stack":[[{"start":{"row":52,"column":24},"end":{"row":53,"column":0},"action":"insert","lines":["",""],"id":2},{"start":{"row":53,"column":0},"end":{"row":53,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":53,"column":2},"end":{"row":53,"column":4},"action":"insert","lines":["''"],"id":3}],[{"start":{"row":53,"column":3},"end":{"row":53,"column":4},"action":"insert","lines":["a"],"id":4}],[{"start":{"row":53,"column":4},"end":{"row":53,"column":5},"action":"insert","lines":["d"],"id":5}],[{"start":{"row":53,"column":4},"end":{"row":53,"column":5},"action":"remove","lines":["d"],"id":6}],[{"start":{"row":53,"column":3},"end":{"row":53,"column":4},"action":"remove","lines":["a"],"id":7}],[{"start":{"row":53,"column":3},"end":{"row":53,"column":4},"action":"insert","lines":["a"],"id":8}],[{"start":{"row":53,"column":4},"end":{"row":53,"column":5},"action":"insert","lines":["d"],"id":9}],[{"start":{"row":53,"column":5},"end":{"row":53,"column":6},"action":"insert","lines":["u"],"id":10}],[{"start":{"row":53,"column":6},"end":{"row":53,"column":7},"action":"insert","lines":["n"],"id":11}],[{"start":{"row":53,"column":7},"end":{"row":53,"column":8},"action":"insert","lines":["h"],"id":12}],[{"start":{"row":53,"column":8},"end":{"row":53,"column":9},"action":"insert","lines":["a"],"id":13}],[{"start":{"row":53,"column":9},"end":{"row":53,"column":10},"action":"insert","lines":["m"],"id":14}],[{"start":{"row":53,"column":11},"end":{"row":53,"column":12},"action":"insert","lines":[" "],"id":15}],[{"start":{"row":53,"column":12},"end":{"row":53,"column":13},"action":"insert","lines":[" "],"id":16}],[{"start":{"row":53,"column":13},"end":{"row":53,"column":14},"action":"insert","lines":["+"],"id":17}],[{"start":{"row":53,"column":13},"end":{"row":53,"column":14},"action":"remove","lines":["+"],"id":18}],[{"start":{"row":53,"column":13},"end":{"row":53,"column":14},"action":"insert","lines":["="],"id":19}],[{"start":{"row":53,"column":14},"end":{"row":53,"column":15},"action":"insert","lines":[">"],"id":20}],[{"start":{"row":53,"column":15},"end":{"row":53,"column":16},"action":"insert","lines":[" "],"id":21}],[{"start":{"row":53,"column":16},"end":{"row":53,"column":18},"action":"insert","lines":["''"],"id":22}],[{"start":{"row":53,"column":17},"end":{"row":53,"column":18},"action":"insert","lines":["["],"id":23}],[{"start":{"row":53,"column":17},"end":{"row":53,"column":18},"action":"remove","lines":["["],"id":24}],[{"start":{"row":53,"column":17},"end":{"row":53,"column":18},"action":"insert","lines":["p"],"id":25}],[{"start":{"row":53,"column":18},"end":{"row":53,"column":19},"action":"insert","lines":["a"],"id":26}],[{"start":{"row":53,"column":19},"end":{"row":53,"column":20},"action":"insert","lines":["s"],"id":27}],[{"start":{"row":53,"column":20},"end":{"row":53,"column":21},"action":"insert","lines":["s"],"id":28}],[{"start":{"row":53,"column":21},"end":{"row":53,"column":22},"action":"insert","lines":["w"],"id":29}],[{"start":{"row":53,"column":22},"end":{"row":53,"column":23},"action":"insert","lines":["o"],"id":30}],[{"start":{"row":53,"column":23},"end":{"row":53,"column":24},"action":"insert","lines":["r"],"id":31}],[{"start":{"row":53,"column":24},"end":{"row":53,"column":25},"action":"insert","lines":["d"],"id":32}],[{"start":{"row":53,"column":26},"end":{"row":54,"column":0},"action":"insert","lines":["",""],"id":33},{"start":{"row":54,"column":0},"end":{"row":54,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":54,"column":2},"end":{"row":54,"column":4},"action":"insert","lines":["''"],"id":34}],[{"start":{"row":54,"column":3},"end":{"row":54,"column":4},"action":"insert","lines":["g"],"id":35}],[{"start":{"row":54,"column":4},"end":{"row":54,"column":5},"action":"insert","lines":["u"],"id":36}],[{"start":{"row":54,"column":5},"end":{"row":54,"column":6},"action":"insert","lines":["e"],"id":37}],[{"start":{"row":54,"column":6},"end":{"row":54,"column":7},"action":"insert","lines":["s"],"id":38}],[{"start":{"row":54,"column":7},"end":{"row":54,"column":8},"action":"insert","lines":["t"],"id":39}],[{"start":{"row":54,"column":9},"end":{"row":54,"column":10},"action":"insert","lines":[" "],"id":40}],[{"start":{"row":54,"column":10},"end":{"row":54,"column":11},"action":"insert","lines":["="],"id":41}],[{"start":{"row":54,"column":11},"end":{"row":54,"column":12},"action":"insert","lines":[">"],"id":42}],[{"start":{"row":54,"column":12},"end":{"row":54,"column":13},"action":"insert","lines":[" "],"id":43}],[{"start":{"row":54,"column":13},"end":{"row":54,"column":15},"action":"insert","lines":["''"],"id":44}],[{"start":{"row":54,"column":14},"end":{"row":54,"column":15},"action":"insert","lines":["g"],"id":45}],[{"start":{"row":54,"column":15},"end":{"row":54,"column":16},"action":"insert","lines":["u"],"id":46}],[{"start":{"row":54,"column":16},"end":{"row":54,"column":17},"action":"insert","lines":["e"],"id":47}],[{"start":{"row":54,"column":17},"end":{"row":54,"column":18},"action":"insert","lines":["s"],"id":48}],[{"start":{"row":54,"column":18},"end":{"row":54,"column":19},"action":"insert","lines":["t"],"id":49}],[{"start":{"row":109,"column":2},"end":{"row":118,"column":8},"action":"remove","lines":["<div style=\"width:500px; margin-left:auto; margin-right:auto; text-align:center\">","  <form method=\"post\">","    <h3>Please enter password to access this page</h3>","    <font color=\"red\"><?php echo $error_msg; ?></font><br />","<?php if (USE_USERNAME) echo 'Login:<br /><input type=\"input\" name=\"access_login\" /><br />Password:<br />'; ?>","    <input type=\"password\" name=\"access_password\" /><p></p><input type=\"submit\" name=\"Submit\" value=\"Submit\" />","  </form>","  <br />","  <a style=\"font-size:9px; color: #B0B0B0; font-family: Verdana, Arial;\" href=\"http://www.zubrag.com/scripts/password-protect.php\" title=\"Download Password Protector\">Powered by Password Protect</a>","  </div>"],"id":50},{"start":{"row":109,"column":2},"end":{"row":127,"column":8},"action":"insert","lines":["<?php include( \"navupdate.html\"); ?>","    <div class=\"container\">","        <div class=\"row\">","            <div class=\"col-md-6 col-md-offset-3\">","                <form class=\"form-signin\" method=\"post\">","                  <h2 class=\"form-signin-heading white-text text-center text-uppercase\">Please sign in</h2>","                  <font color=\"red\"><?php echo $error_msg; ?></font><br />","                  <?php if (USE_USERNAME) echo '<p class=\"white-text\">Login</p?:<br /><input type=\"input\" name=\"access_login\" class=\"form-control white-text\"/><br />Password:<br />'; ?>","                    <!--<label for=\"inputEmail\" class=\"sr-only\">Username</label>","                    <input type=\"input\" name=\"access_login\" class=\"form-control\" placeholder=\"Username\" required autofocus>","                    <label for=\"inputPassword\" class=\"sr-only\">Password</label>-->","                    <input type=\"password\" name=\"access_password\" class=\"form-control\" required>","                    <button class=\"btn btn-lg btn-primary btn-block orange darken-3\" type=\"submit\" name=\"Submit\">Sign in</button>","                </form>","                <a style=\"font-size:9px; color: #B0B0B0; font-family: Verdana, Arial;\" href=\"http://www.zubrag.com/scripts/password-protect-advanced.php\" title=\"Download Password Protect\">Powered by Password Protect</a>","            </div>","        </div>","    </div>","  <br />"]}],[{"start":{"row":105,"column":5},"end":{"row":105,"column":6},"action":"insert","lines":[" "],"id":51}],[{"start":{"row":105,"column":6},"end":{"row":109,"column":14},"action":"insert","lines":["style=\"background: url(reemscreek/Photos/sunset1.jpg) no-repeat center center fixed; -webkit-background-size: cover;","-moz-background-size: cover;","  -o-background-size: cover;","  background-size: cover\" ","  class=\"well\""],"id":52}],[{"start":{"row":101,"column":2},"end":{"row":103,"column":47},"action":"remove","lines":["<title>Please enter password to access this page</title>","  <META HTTP-EQUIV=\"CACHE-CONTROL\" CONTENT=\"NO-CACHE\">","  <META HTTP-EQUIV=\"PRAGMA\" CONTENT=\"NO-CACHE\">"],"id":53},{"start":{"row":101,"column":2},"end":{"row":119,"column":47},"action":"insert","lines":["<meta charset=\"utf-8\">","    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">","    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">","    <!-- The above 3 meta tags *must* come first in the head;","any other head content must come *after* these tags -->","    <meta name=\"description\" content=\"\">","    <meta name=\"author\" content=\"\">","    <link rel=\"icon\" href=\"../../favicon.ico\">","    <title>Please enter password to access this page</title>","    <!-- Bootstrap core CSS -->","    <link href=\"../Bootstrap/bootstrap-paper.min.css\" rel=\"stylesheet\">","    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->","    <link href=\"../../assets/css/ie10-viewport-bug-workaround.css\" rel=\"stylesheet\">","    <!-- Custom styles for this template -->","    <link href=\"signin.css\" rel=\"stylesheet\">","    <link href=\"../Custom%20Css/Colors.css\" rel=\"stylesheet\">","    <link href=\"../Custom%20Css/Personal.css\" rel=\"stylesheet\">","  <META HTTP-EQUIV=\"CACHE-CONTROL\" CONTENT=\"NO-CACHE\">","  <META HTTP-EQUIV=\"PRAGMA\" CONTENT=\"NO-CACHE\">"]}],[{"start":{"row":52,"column":24},"end":{"row":52,"column":25},"action":"insert","lines":[","],"id":54}],[{"start":{"row":53,"column":26},"end":{"row":53,"column":27},"action":"insert","lines":[","],"id":55}]]},"ace":{"folds":[],"scrolltop":467,"scrollleft":0,"selection":{"start":{"row":53,"column":27},"end":{"row":53,"column":27},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":32,"state":"php-comment","mode":"ace/mode/php"}},"timestamp":1454541845363}